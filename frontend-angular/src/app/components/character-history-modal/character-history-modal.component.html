<div class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <!-- Header -->
      <div class="modal-header">
        <h3 class="text-sm font-mono text-[#666]">
          HISTORIQUE MENSUEL // {{ character.name | uppercase }}
        </h3>
        <button (click)="closeModal()" class="close-button">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
  
      <!-- Body -->
      <div class="modal-body">
        <ng-container *ngIf="characterTickets.length > 0; else noHistory">
            <table class="w-full border-collapse font-mono text-xs">
                <thead class="text-[#666]">
                  <tr class="border-b border-[#222]">
                    <th class="p-2 text-left">DATE</th>
                    <th class="p-2 text-left">STATUT</th>
                    <th class="p-2 text-left">BILAN</th>
                    <th class="p-2 text-left">COTE</th>
                    <th class="p-2 text-left">PARIS</th>
                  </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let ticket of characterTickets" class="border-b border-[#111]"
                        [ngClass]="{
                            'ticket-won': ticket.status === 'won',
                            'ticket-lost': ticket.status === 'lost'
                        }">
                        <td class="p-2 align-top">{{ ticket.date }}</td>
                        <td class="p-2 align-top">
                            <span class="font-bold"
                                [ngClass]="{'text-green-400': ticket.status === 'won', 'text-red-400': ticket.status === 'lost'}">
                                {{ ticket.status | uppercase }}
                            </span>
                        </td>
                        <td class="p-2 align-top font-bold"
                            [ngClass]="{'text-green-400': ticket.status === 'won', 'text-red-400': ticket.status === 'lost'}">
                            {{ ticket.status === 'won' ? '+' : '-' }}{{ getTicketProfit(ticket) | number:'1.2-2' }}€
                        </td>
                        <td class="p-2 align-top">{{ ticket.totalOdd | number:'1.2-2' }}</td>
                        <td class="p-2 align-top">
                            <div *ngFor="let bet of ticket.bets" class="text-gray-300">
                                - {{ bet.home_team?.name }} vs {{ bet.away_team?.name }} ({{ bet.market }})
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </ng-container>
        <ng-template #noHistory>
            <div class="text-center p-8 text-[#666]">
                <p>Aucun ticket 'The Oracle\'s Choice' gagné ou perdu ce mois-ci.</p>
            </div>
        </ng-template>
      </div>
    </div>
</div>
  